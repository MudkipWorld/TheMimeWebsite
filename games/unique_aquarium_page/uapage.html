<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Unique Aquarium</title>

  <link rel="stylesheet" href="../../news/news.css?v=<?= new Date().getTime() ?>" />
  <link rel="stylesheet" href="../unique_aquarium_page/uapage.css?v=<?= new Date().getTime() ?>" /> 
  <link rel="stylesheet" href="../games.css?v=<?= new Date().getTime() ?>" /> 

  <script>
    const ts = new Date().getTime();
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('link[rel="stylesheet"]').forEach(link => {
            link.href += "?v=" + ts;
        });
    });
  </script>
  

<style>
@media screen and (max-width: 900px) and (orientation: portrait) {
    #game_wrapper {
        transform: rotate(90deg);
        transform-origin: left top;
        width: 100vh;   
        height: 100vw; 
        overflow: hidden;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #000; 
    }

    #game_wrapper iframe {
        width: 100%;
        height: 100%;
        border: none;
    }
}

#rotateNotice {
    display: none;
    position: fixed;
    top:0;
    left:0;
    width: 100%;
    height: 100%;
    background: #000;
    color: #fff;
    text-align: center;
    line-height: 100vh;
    font-size: 1.5rem;
    z-index: 9999;
}
</style>

</head>
<body>
  <div class="flex-container">
    <div class="row_flex_container">
      <img src="../../assets/main_page_assets/themime_logo.svg" alt="Mime Logo"
           onclick="loadPage('../../main/main.html')" class="logo_image"/>
      <div class="top_buttons_div">
        <img src="../../games/unique_aquarium_page/BannerBig.png" >
      </div>
    </div>

    <div class="bodybg">
      <div id="subview" style="font-family: 'MouldyCheese'">
        <div class="main_colored_background"></div>
        <div class="main_container">
          <div id="GamePlayer" class="centered_container" style="display:flex;">
            <div class="minigames_top_buttons_container">
              <button id="fullscreenButton" class="top_minigames_toggles">Fullscreen</button>
              <button onclick="exit_game()" class="top_minigames_toggles">Back</button>
            </div>
            <div class="iframe_wrapper" id="game_wrapper">
              <iframe class="game_embed" id="GameEmbed" scrolling="no"></iframe>
            </div>
            <p align="center">
              Note: if any of the games have a save and you want to backup, check the Settings in game and see the Backups section.
              <br>You will have a download of the save file. If you never played the game before on your Desktop. Make sure it is named "backup.savedata" and put it next to the executable.
              <br>If you already had a save file, but wish to continue the one from web. look for the %appdata%/Roaming/Godot and look for Unique Aquarium inside the user apps folder and paste the downloaded save there.
            </p>
            <a href="https://discord.gg/QtvDjY4t42" target="_blank" rel="noopener noreferrer">
              <button class="play_button" style="display: contents;">
                <p align="right">Discord!</p>
              </button>
            </a>
            <a href="https://ko-fi.com/themime2111"  target="_blank" rel="noopener noreferrer">
                <button class="play_button" style="display: contents;">
                    <p align="right">Buy me Kofi!</p>
                </button>
            </a>  
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const timestamp = () => new Date().getTime();
function loadGame() {
    const wrapper = document.getElementById('game_wrapper');

    wrapper.innerHTML = '';

    const iframe = document.createElement('iframe');
    iframe.className = 'game_embed';
    iframe.scrolling = 'no';
    iframe.src = '../../games/games/unique_aquarium/unique_aquarium.html?v=' + timestamp();

    wrapper.appendChild(iframe);

    resize_iframe_to_canvas();
}


function checkOrientation() {
    const notice = document.getElementById('rotateNotice');
    const wrapper = document.getElementById('game_wrapper');
    if(window.innerHeight > window.innerWidth){ 
        notice.style.display = 'block';
        wrapper.style.display = 'none';
    } else { 
        notice.style.display = 'none';
        wrapper.style.display = 'flex';
    }
}

function resize_iframe_to_canvas() {
    const iframe = document.querySelector('#game_wrapper iframe');
    if (!iframe || !iframe.contentWindow) return;
    const canvas = iframe.contentWindow.document.getElementById('canvas');
    if (!canvas) return;
    canvas.width = iframe.clientWidth + "px";
    canvas.height = iframe.clientHeight + "px";
}

document.getElementById('fullscreenButton').addEventListener('click', function() {
    const iframe = document.querySelector('#game_wrapper iframe');
    if (iframe.requestFullscreen) {
        iframe.requestFullscreen({navigationUI: 'hide'});
    }
});

document.addEventListener('DOMContentLoaded', () => {
    loadGame();
    checkOrientation();
});

window.addEventListener('resize', checkOrientation);
window.addEventListener('orientationchange', checkOrientation);
</script>


</body>
</html>
